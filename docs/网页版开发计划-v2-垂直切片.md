# Qimi AI ç½‘é¡µç‰ˆå¼€å‘è®¡åˆ’ v3.2

> **ç‰ˆæœ¬**: 3.5ï¼ˆå®Œæ•´ç‰ˆï¼‰
> **æ—¥æœŸ**: 2026-01-26
> **çŠ¶æ€**: âœ… Sprint 0 å®Œæˆï¼ŒSprint 1.1 å®Œæˆï¼Œè¿›è¡Œä¸­ Sprint 1.2
> **å®¡æŸ¥çŠ¶æ€**: âœ… å››æ–¹é¢å®¡æŸ¥å®Œæˆå¹¶æ•´åˆ
> **éªŒè¯è§„èŒƒ**: âœ… å·²æ·»åŠ è¡Œä¸šæ ‡å‡†éªŒè¯æµç¨‹
> **æœ€æ–°å˜æ›´**: Sprint 1.1 å®Œæˆ - DeepSeek API ç›´è¿é›†æˆã€SSEæµå¼å“åº”ã€å¯¼èˆªç»Ÿä¸€

---

## ä¸€ã€æ¶æ„è§„èŒƒ

### 1.1 ç›®å½•ç»“æ„è§„èŒƒ

```
/
â”œâ”€â”€ pages/                    # Next.js è·¯ç”±
â”‚   â”œâ”€â”€ api/                  # API Routesï¼ˆä»…ä»£ç†å±‚ï¼‰
â”‚   â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”‚   â”œâ”€â”€ stream.ts    # â†’ ä»£ç†åˆ°åç«¯
â”‚   â”‚   â”‚   â””â”€â”€ stop.ts
â”‚   â”‚   â”œâ”€â”€ conversations/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”‚   â””â”€â”€ [id].ts
â”‚   â”‚   â”œâ”€â”€ mood/
â”‚   â”‚   â”œâ”€â”€ plan/
â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â””â”€â”€ migrate-guest.ts  # è®¿å®¢è¿ç§»
â”‚   â”‚   â”œâ”€â”€ user-stats.ts    # âœ… å·²å®ç° - å…¨çƒç”¨æˆ·ç»Ÿè®¡ï¼ˆä»£ç†åç«¯ï¼‰
â”‚   â”‚   â”œâ”€â”€ subscribe.ts     # Mailchimpé‚®ä»¶è®¢é˜…ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â””â”€â”€ auth/
â”‚   â”œâ”€â”€ index.tsx            # Landing
â”‚   â”œâ”€â”€ chat.tsx             # å¯¹è¯é¡µ
â”‚   â”œâ”€â”€ dashboard.tsx        # ä»ªè¡¨æ¿
â”‚   â”œâ”€â”€ mood.tsx             # å¿ƒæƒ…è¿½è¸ª
â”‚   â”œâ”€â”€ plan.tsx             # æˆé•¿æ–¹æ¡ˆ
â”‚   â”œâ”€â”€ calm.tsx             # ç´§æ€¥å†·é™
â”‚   â”œâ”€â”€ privacy.tsx          # éšç§æ”¿ç­–
â”‚   â”œâ”€â”€ terms.tsx            # æœåŠ¡æ¡æ¬¾
â”‚   â””â”€â”€ settings.tsx         # ç”¨æˆ·è®¾ç½®ï¼ˆæ•°æ®åˆ é™¤/å¯¼å‡ºï¼‰
â”‚
â”œâ”€â”€ components/               # UIç»„ä»¶
â”‚   â”œâ”€â”€ Chat/
â”‚   â”œâ”€â”€ Mood/
â”‚   â”œâ”€â”€ Plan/
â”‚   â”œâ”€â”€ Calm/
â”‚   â”œâ”€â”€ Dashboard/
â”‚   â”œâ”€â”€ Layout/
â”‚   â”‚   â””â”€â”€ ErrorBoundary.tsx  # é”™è¯¯è¾¹ç•Œ
â”‚   â””â”€â”€ UI/
â”‚       â”œâ”€â”€ CookieConsent.tsx
â”‚       â””â”€â”€ AgeGate.tsx
â”‚
â”œâ”€â”€ services/                 # APIæœåŠ¡å±‚
â”‚   â”œâ”€â”€ api-client.ts        # ç»Ÿä¸€HTTPå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ chat.ts
â”‚   â”œâ”€â”€ conversation.ts
â”‚   â”œâ”€â”€ mood.ts
â”‚   â”œâ”€â”€ plan.ts
â”‚   â”œâ”€â”€ guest.ts
â”‚   â””â”€â”€ auth.ts
â”‚
â”œâ”€â”€ stores/                   # çŠ¶æ€ç®¡ç† (Zustand)
â”‚   â”œâ”€â”€ chatStore.ts
â”‚   â”œâ”€â”€ userStore.ts
â”‚   â”œâ”€â”€ moodStore.ts
â”‚   â”œâ”€â”€ planStore.ts
â”‚   â””â”€â”€ uiStore.ts
â”‚
â”œâ”€â”€ types/                    # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ api.ts
â”‚   â”œâ”€â”€ chat.ts
â”‚   â”œâ”€â”€ mood.ts
â”‚   â”œâ”€â”€ plan.ts
â”‚   â”œâ”€â”€ user.ts
â”‚   â””â”€â”€ index.ts             # ç»Ÿä¸€å¯¼å‡º
â”‚
â”œâ”€â”€ constants/                # å¸¸é‡
â”‚   â”œâ”€â”€ api.ts               # APIç«¯ç‚¹
â”‚   â”œâ”€â”€ challenges.ts        # ADHDæŒ‘æˆ˜åˆ†ç±»
â”‚   â””â”€â”€ config.ts            # é…ç½®é¡¹
â”‚
â”œâ”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ format.ts            # formatFileSize, getFileIcon
â”‚   â”œâ”€â”€ validation.ts
â”‚   â””â”€â”€ storage.ts           # localStorageå°è£…
â”‚
â””â”€â”€ hooks/                    # è‡ªå®šä¹‰Hooks
    â”œâ”€â”€ useChat.ts
    â”œâ”€â”€ useMood.ts
    â”œâ”€â”€ useAuth.ts
    â””â”€â”€ useGuestMode.ts
```

### 1.2 ç±»å‹å®šä¹‰è§„èŒƒ

```typescript
// types/api.ts - ç»Ÿä¸€APIå“åº”æ ¼å¼
export interface ApiResponse<T = unknown> {
  success: boolean;
  data?: T;
  error?: {
    code: string;
    message: string;
    details?: Record<string, unknown>;
  };
}

// types/chat.ts - èŠå¤©ç›¸å…³ç±»å‹
export interface Message {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: string;
  attachments?: Attachment[];
  sources?: RAGSource[];
  isStreaming?: boolean;
}

export interface Attachment {
  type: 'image' | 'pdf' | 'doc' | 'text';
  name: string;
  size: number;
  base64?: string;
  url?: string;
}

export interface Conversation {
  id: string;
  userId: string;
  title: string;
  folderKey: TopicFolder | null;
  createdAt: string;
  updatedAt: string;
}

export type TopicFolder =
  | 'emotion' | 'learning' | 'exercise' | 'nutrition'
  | 'social' | 'sleep' | 'school' | 'supplement';

// types/mood.ts
export interface MoodRecord {
  id: string;
  userId: string;
  mood: MoodLevel;
  score: number;
  timestamp: string;
  source: 'manual' | 'chat';
  note?: string;
}

export type MoodLevel =
  | 'very_anxious' | 'anxious' | 'neutral' | 'calm' | 'very_calm';

// types/plan.ts
export interface ActionPlanItem {
  id: string;
  category: PlanCategory;
  painPoint: string;
  strategy: string;
  star: boolean;
  checkInDays: string[];
  sourceMessageId?: string;
  createdAt: string;
}

export type PlanCategory =
  | 'emotion' | 'learning' | 'exercise' | 'nutrition'
  | 'social' | 'sleep' | 'school';

// types/user.ts
export interface User {
  id: string;
  email: string;
  name?: string;
  avatar?: string;
  createdAt: string;
}

export interface ChildProfile {
  birthYear: number;
  birthMonth: number;
  challenges: string[];
  name?: string;
}

export interface GuestData {
  sessionId: string;
  childProfile?: ChildProfile;
  chatHistory: Message[];
  messageCount: number;
  createdAt: string;
  expiresAt: string;
}
```

### 1.3 APIç«¯ç‚¹è§„èŒƒ

```typescript
// constants/api.ts
export const API_BASE = process.env.NEXT_PUBLIC_API_URL || 'https://api.xingbanai.cn';

export const ENDPOINTS = {
  AUTH: {
    LOGIN: '/auth/login',
    WX_LOGIN: '/auth/wx-login',
  },
  CHAT: {
    STREAM: '/adviser/chat-stream',
    SYNC: '/adviser/chat',
    STOP: '/adviser/stop',
  },
  CONVERSATIONS: {
    LIST: '/conversations',
    CREATE: '/conversations',
    UPDATE: (id: string) => `/conversations/${id}`,
    DELETE: (id: string) => `/conversations/${id}`,
    MESSAGES: (id: string) => `/messages/${id}`,
  },
  MOOD: {
    RECORD: '/api/mood/record',
    HISTORY: '/api/mood/history',
    STATS: '/api/mood/stats',
    DELETE: (id: string) => `/api/mood/record/${id}`,
  },
  PLAN: {
    GET: '/api/action-plan',
    GENERATE: '/api/action-plan/generate',
    SAVE_FROM_CHAT: '/api/action-plan/save-from-chat-stream',
    STAR: '/api/action-plan/star',
    CHECK_IN: '/api/action-plan/check-in',
    UPDATE_ITEM: (id: string) => `/api/action-plan/items/${id}`,
    DELETE_ITEM: '/api/action-plan/item',
    EXPORT_PDF: '/api/action-plan/export-pdf',
  },
  QUOTA: {
    USE: '/api/quota/use',
    STATUS: '/api/quota/status',
  },
  STATS: {
    USERS: '/api/stats/users',  // å…¨çƒæ³¨å†Œç”¨æˆ·ç»Ÿè®¡ï¼ˆå°ç¨‹åº+ç½‘é¡µç‰ˆï¼‰
  },
  PROFILE: {
    GET: '/profile/get',
    INIT: '/profile/quick-init',
    UPDATE: '/profile/update',
  },
} as const;
```

### 1.4 æœåŠ¡å±‚è§„èŒƒ

```typescript
// services/api-client.ts
class ApiError extends Error {
  constructor(
    public status: number,
    public code: string,
    message: string,
    public details?: unknown
  ) {
    super(message);
    this.name = 'ApiError';
  }
}

class ApiClient {
  private baseUrl: string;
  private defaultHeaders: HeadersInit = {
    'Content-Type': 'application/json',
  };

  constructor(baseUrl: string) {
    this.baseUrl = baseUrl;
  }

  async request<T>(endpoint: string, options: RequestInit = {}): Promise<T> {
    const url = `${this.baseUrl}${endpoint}`;
    const response = await fetch(url, {
      ...options,
      headers: { ...this.defaultHeaders, ...options.headers },
      signal: options.signal || AbortSignal.timeout(30000),
    });

    if (!response.ok) {
      const errorData = await response.json().catch(() => ({}));
      throw new ApiError(
        response.status,
        errorData.error || 'UNKNOWN_ERROR',
        errorData.message || `HTTP ${response.status}`,
        errorData.details
      );
    }
    return response.json();
  }

  async *stream(endpoint: string, body: unknown): AsyncGenerator<SSEChunk> {
    const response = await fetch(`${this.baseUrl}${endpoint}`, {
      method: 'POST',
      headers: this.defaultHeaders,
      body: JSON.stringify(body),
    });

    if (!response.ok) {
      throw new ApiError(response.status, 'STREAM_ERROR', 'Stream failed');
    }

    const reader = response.body?.getReader();
    if (!reader) throw new Error('No response body');

    const decoder = new TextDecoder();
    let buffer = '';

    while (true) {
      const { done, value } = await reader.read();
      if (done) break;

      buffer += decoder.decode(value, { stream: true });
      const lines = buffer.split('\n');
      buffer = lines.pop() || '';

      for (const line of lines) {
        if (line.startsWith('data: ')) {
          const data = line.slice(6);
          if (data === '[DONE]') return;
          yield JSON.parse(data);
        }
      }
    }
  }

  get = <T>(ep: string) => this.request<T>(ep, { method: 'GET' });
  post = <T>(ep: string, body: unknown) => this.request<T>(ep, { method: 'POST', body: JSON.stringify(body) });
  patch = <T>(ep: string, body: unknown) => this.request<T>(ep, { method: 'PATCH', body: JSON.stringify(body) });
  delete = <T>(ep: string) => this.request<T>(ep, { method: 'DELETE' });
}

export const apiClient = new ApiClient(API_BASE);
export { ApiError };
```

---

## äºŒã€å®‰å…¨è§„èŒƒ

### 2.1 å¿…é¡»ä¿®å¤çš„å®‰å…¨é—®é¢˜ï¼ˆå·²æ•´åˆåˆ°Sprintä»»åŠ¡ï¼‰

| é—®é¢˜ | æ–‡ä»¶ | ä¸¥é‡æ€§ | ä¿®å¤Sprint |
|------|------|--------|-----------|
| dangerouslySetInnerHTML XSS | mockup.tsx:100 | ğŸ”´ é«˜ | Sprint 0 |
| NextAuthé…ç½®ä¸å®Œæ•´ | [...nextauth].ts | ğŸ”´ é«˜ | Sprint 0 |
| æ— å®‰å…¨Headers | next.config.mjs | ğŸŸ¡ ä¸­ | Sprint 0 |
| localStorageæ˜æ–‡å­˜å‚¨ | guest-storage.ts | ğŸŸ¡ ä¸­ | Sprint 1 |
| console.logæœªç§»é™¤ | chat.tsx:155,159 | ğŸŸ¡ ä¸­ | Sprint 1 |

### 2.2 å®‰å…¨Headersé…ç½®

```javascript
// next.config.mjs
async headers() {
  return [{
    source: '/:path*',
    headers: [
      { key: 'X-Content-Type-Options', value: 'nosniff' },
      { key: 'X-Frame-Options', value: 'DENY' },
      { key: 'X-XSS-Protection', value: '1; mode=block' },
      { key: 'Referrer-Policy', value: 'strict-origin-when-cross-origin' },
      { key: 'Content-Security-Policy', value: "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';" },
    ],
  }];
}
```

---

## ä¸‰ã€å‚ç›´åˆ‡ç‰‡å¼€å‘è®¡åˆ’

### Sprint 0: åŸºç¡€è®¾æ–½ + å®‰å…¨ä¿®å¤ï¼ˆç¬¬1å‘¨å‰åŠï¼‰

**ç›®æ ‡**: å»ºç«‹ä»£ç è§„èŒƒã€ä¿®å¤å®‰å…¨é—®é¢˜ã€æ­å»ºåŸºç¡€æ¶æ„

```
ä»»åŠ¡æ¸…å•:

0.1 å®‰å…¨é—®é¢˜ä¿®å¤ (P0 - é˜»æ–­é¡¹)
â”œâ”€â”€ [x] ç§»é™¤ dangerouslySetInnerHTML
â”‚   â””â”€â”€ æ–‡ä»¶: pages/mockup.tsx å·²åˆ é™¤
â”‚   â””â”€â”€ æ–¹æ¡ˆ: æ”¹ç”¨ react-markdown
â”‚
â”œâ”€â”€ [x] å®Œå–„NextAuthé…ç½®
â”‚   â””â”€â”€ æ–‡ä»¶: pages/api/auth/[...nextauth].ts
â”‚   â””â”€â”€ æ·»åŠ : callbacks, pages, sessioné…ç½®
â”‚
â””â”€â”€ [x] æ·»åŠ å®‰å…¨Headers
    â””â”€â”€ æ–‡ä»¶: next.config.mjs

0.2 åˆ›å»ºç›®å½•ç»“æ„
â”œâ”€â”€ [x] mkdir services/
â”œâ”€â”€ [x] mkdir stores/
â”œâ”€â”€ [x] mkdir types/
â””â”€â”€ [x] mkdir constants/

0.3 ç±»å‹å®šä¹‰
â”œâ”€â”€ [x] types/api.ts
â”œâ”€â”€ [x] types/chat.ts
â”œâ”€â”€ [x] types/mood.ts
â”œâ”€â”€ [x] types/plan.ts
â”œâ”€â”€ [x] types/user.ts
â””â”€â”€ [x] types/index.ts (ç»Ÿä¸€å¯¼å‡º)

0.4 APIæœåŠ¡å±‚åŸºç¡€
â”œâ”€â”€ [x] services/api-client.ts
â”œâ”€â”€ [x] constants/api.ts
â””â”€â”€ [x] æµ‹è¯•åç«¯APIè¿é€šæ€§ (/api/user-stats å·²éªŒè¯)

0.5 ä»£ç æ¸…ç†
â”œâ”€â”€ [x] æå–é‡å¤å‡½æ•°åˆ° utils/format.ts
â”‚   â”œâ”€â”€ formatFileSize (ChatInput.tsx:44-48, StreamingMessage.tsx:25-29)
â”‚   â””â”€â”€ getFileIcon (ChatInput.tsx:51-62, StreamingMessage.tsx:32-37)
â”‚
â”œâ”€â”€ [x] ç»Ÿä¸€Messageç±»å‹å®šä¹‰
â”‚   â””â”€â”€ åˆ é™¤ useStreamingChat.ts å’Œ guest-storage.ts ä¸­çš„é‡å¤å®šä¹‰
â”‚
â”œâ”€â”€ [x] ä¿®å¤package.jsonä¾èµ–é‡å¤
â”‚   â””â”€â”€ ç§»é™¤devDependenciesä¸­çš„react/react-dom
â”‚
â””â”€â”€ [x] æ·»åŠ ErrorBoundaryç»„ä»¶
    â””â”€â”€ components/Layout/ErrorBoundary.tsx

0.6 çŠ¶æ€ç®¡ç†åŸºç¡€
â”œâ”€â”€ [x] npm install zustand
â””â”€â”€ [x] stores/userStore.ts (åŸºç¡€ç»“æ„)

éªŒæ”¶æ ‡å‡†:
âœ“ npm run build æ— é”™è¯¯ âœ… å·²éªŒè¯
âœ“ npm run lint æ— è­¦å‘Š âš ï¸ æœªé…ç½®lint script
âœ“ èƒ½pingé€šåç«¯API https://api.xingbanai.cn âœ… å·²éªŒè¯
âœ“ å®‰å…¨Headersåœ¨å“åº”ä¸­å­˜åœ¨ âœ… å·²é…ç½®

âš ï¸ éªŒè¯æ£€æŸ¥ç‚¹ï¼ˆå‚è€ƒç¬¬å…­ç« ï¼‰:
â”œâ”€â”€ [x] å®Œæˆ 6.3 éªŒè¯æ£€æŸ¥æ¸…å•
â”œâ”€â”€ [ ] ä»£ç å·²Reviewå¹¶åˆå¹¶
â””â”€â”€ [ ] Sprint Reviewæ¼”ç¤ºé€šè¿‡
```

---

### Sprint 1: å¯¹è¯åŠŸèƒ½å®Œæ•´æ‰“é€šï¼ˆç¬¬1å‘¨ååŠ - ç¬¬2å‘¨ï¼‰

**ç›®æ ‡**: ç”¨çœŸå®APIæ›¿æ¢Mockæ•°æ®ï¼Œå¯¹è¯å®Œæ•´å¯ç”¨

```
åŠŸèƒ½åˆ‡ç‰‡ 1.1: å‘é€æ¶ˆæ¯ + æµå¼å“åº” âœ… å·²å®Œæˆ

> **æ¶æ„å˜æ›´**: é‡‡ç”¨ DeepSeek API ç›´è¿æ–¹æ¡ˆï¼ˆè€Œéä»£ç†åˆ°å°ç¨‹åºåç«¯ï¼‰
> - åŸå› : åŒ—ç¾ç”¨æˆ·å»¶è¿Ÿä¼˜åŒ–ã€ç‹¬ç«‹äºå›½å†…åç«¯
> - API Key å­˜å‚¨äºæœåŠ¡ç«¯ç¯å¢ƒå˜é‡ï¼Œå®‰å…¨å¯æ§

åç«¯API
â”œâ”€â”€ [x] pages/api/chat/stream.ts
â”‚   â”œâ”€â”€ ç›´æ¥è°ƒç”¨ DeepSeek API (https://api.deepseek.com)
â”‚   â”œâ”€â”€ å¤„ç†SSEæµå¼å“åº”
â”‚   â”œâ”€â”€ ä»NextAuth sessionè·å–userId
â”‚   â”œâ”€â”€ è®¿å®¢ä½¿ç”¨ guest_{sessionId} æˆ– guest_{cookie}
â”‚   â””â”€â”€ âœ… å®Œæ•´System Prompt (å·²åŒæ­¥å°ç¨‹åºæ ¸å¿ƒæ–¹æ³•è®º)
â”‚
â””â”€â”€ [x] pages/api/chat/stop.ts
    â””â”€â”€ ä¸­æ–­ç”Ÿæˆï¼ˆé€šè¿‡ AbortControllerï¼‰

æœåŠ¡å±‚
â””â”€â”€ [x] services/chat.ts
    â”œâ”€â”€ streamChat(content, attachments?, callbacks)
    â””â”€â”€ stopGeneration()

çŠ¶æ€ç®¡ç†
â””â”€â”€ [x] stores/chatStore.ts (Zustand)
    â”œâ”€â”€ messages: Message[]
    â”œâ”€â”€ isStreaming: boolean
    â”œâ”€â”€ abortController: AbortController | null
    â””â”€â”€ actions: sendMessage, stopStream, clearMessages, setMessages

Hookæ›´æ–°
â””â”€â”€ [x] hooks/useChat.ts
    â”œâ”€â”€ åˆ é™¤MOCK_RESPONSES
    â”œâ”€â”€ ä½¿ç”¨chatStore
    â””â”€â”€ è¿æ¥çœŸå®API

åŠŸèƒ½é€»è¾‘ä¿®å¤
â”œâ”€â”€ [x] ä¿®å¤è·¯ç”±å‚æ•°é‡å¤è§¦å‘ (chat.tsx)
â”‚   â””â”€â”€ æ·»åŠ  modeHandledRef é˜²æ­¢åˆ·æ–°é‡å‘
â”‚
â”œâ”€â”€ [x] ç§»é™¤console.log
â”‚
â””â”€â”€ [x] åŒæ—¶è®°å½•ç”¨æˆ·æ¶ˆæ¯å’ŒAIå›å¤åˆ°å†å²

å…¶ä»–å®Œæˆé¡¹
â”œâ”€â”€ [x] å¯¼èˆªæ ç»Ÿä¸€ (LandingLayout.tsx ä¸ index.tsx å¯¹é½)
â”œâ”€â”€ [x] è®¿å®¢æ¶ˆæ¯é™åˆ¶æš‚æ—¶ç¦ç”¨ (æµ‹è¯•é˜¶æ®µ 999 æ¡)
â”œâ”€â”€ [x] NextAuth ç±»å‹æ‰©å±• (types/next-auth.d.ts)
â””â”€â”€ [x] Promptç³»ç»Ÿæ¢ç´¢æ–‡æ¡£åŒ– (å°ç¨‹åº prompts.js åˆ†æ)

éªŒæ”¶æ ‡å‡†: âœ… å…¨éƒ¨é€šè¿‡
âœ“ è¾“å…¥æ¶ˆæ¯ â†’ DeepSeekå“åº” â†’ æµå¼æ˜¾ç¤º
âœ“ é¦–å­—å“åº” < 1ç§’ (åŒ—ç¾å»¶è¿Ÿå¯æ¥å—)
âœ“ StopæŒ‰é’®èƒ½ä¸­æ–­ç”Ÿæˆ
âœ“ åˆ·æ–°é¡µé¢ä¸ä¼šé‡å¤å‘é€modeæ¶ˆæ¯
âœ“ AIè‡ªç§°"Qimi AI"ï¼Œå…·å¤‡ADHDè‚²å„¿ä¸“ä¸šäººè®¾
```

```
åŠŸèƒ½åˆ‡ç‰‡ 1.2: ä¼šè¯æŒä¹…åŒ–

åç«¯ä»£ç†
â”œâ”€â”€ [ ] pages/api/conversations/index.ts
â”‚   â”œâ”€â”€ GET: è·å–ä¼šè¯åˆ—è¡¨
â”‚   â””â”€â”€ POST: åˆ›å»ºä¼šè¯
â”‚
â””â”€â”€ [ ] pages/api/conversations/[id].ts
    â”œâ”€â”€ GET: è·å–å•ä¸ªä¼šè¯+æ¶ˆæ¯
    â”œâ”€â”€ PATCH: æ›´æ–°ä¼šè¯
    â””â”€â”€ DELETE: åˆ é™¤ä¼šè¯

æœåŠ¡å±‚
â””â”€â”€ [ ] services/conversation.ts
    â”œâ”€â”€ listConversations(userId)
    â”œâ”€â”€ createConversation(title, folderKey)
    â”œâ”€â”€ getConversation(id)
    â”œâ”€â”€ updateConversation(id, updates)
    â””â”€â”€ deleteConversation(id)

çŠ¶æ€ç®¡ç†æ‰©å±•
â””â”€â”€ [ ] stores/chatStore.ts
    â”œâ”€â”€ conversations: Conversation[]
    â””â”€â”€ actions: loadConversations, selectConversation

UIæ›´æ–°
â””â”€â”€ [ ] components/Chat/SmartDrawer.tsx
    â”œâ”€â”€ æ˜¾ç¤ºçœŸå®ä¼šè¯åˆ—è¡¨ (æ›¿æ¢Mockæ•°æ®)
    â”œâ”€â”€ å®ç°ä¸»é¢˜é€‰æ‹©é€»è¾‘ (chat.tsx:154-157)
    â”œâ”€â”€ å®ç°ä¼šè¯åˆ‡æ¢é€»è¾‘ (chat.tsx:159-162)
    â””â”€â”€ åˆ é™¤/é‡å‘½ååŠŸèƒ½

éªŒæ”¶æ ‡å‡†:
âœ“ åˆ·æ–°é¡µé¢åå¯¹è¯ä»åœ¨
âœ“ åˆ‡æ¢ä¼šè¯åŠ è½½å†å²æ¶ˆæ¯
âœ“ åˆ é™¤ä¼šè¯åä»åˆ—è¡¨æ¶ˆå¤±
âœ“ ç‚¹å‡»ä¸»é¢˜åˆ›å»ºå¯¹åº”å¯¹è¯
```

```
åŠŸèƒ½åˆ‡ç‰‡ 1.3: è®¿å®¢æ¨¡å¼ä¸ç™»å½•è¿ç§»

æœåŠ¡å±‚
â””â”€â”€ [ ] services/guest.ts
    â”œâ”€â”€ saveGuestData(data)
    â”œâ”€â”€ getGuestData()
    â”œâ”€â”€ migrateToUser(userId)
    â””â”€â”€ clearGuestData()

åç«¯
â””â”€â”€ [ ] pages/api/user/migrate-guest.ts (æ–°å»º!)
    â”œâ”€â”€ éœ€è¦sessionè®¤è¯
    â””â”€â”€ å°†è®¿å®¢æ•°æ®ä¿å­˜åˆ°Redis

çŠ¶æ€ç®¡ç†
â””â”€â”€ [ ] stores/userStore.ts
    â”œâ”€â”€ isGuest: boolean
    â”œâ”€â”€ guestMessageCount: number
    â””â”€â”€ user: User | null

localStorageå®‰å…¨
â””â”€â”€ [ ] æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
    â””â”€â”€ æˆ–æ”¹ç”¨sessionStorage

UIæ›´æ–°
â””â”€â”€ [ ] ç™»å½•åè‡ªåŠ¨è¿ç§»æ•°æ® (ä¿®å¤chat.tsx:81-84)

éªŒæ”¶æ ‡å‡†:
âœ“ è®¿å®¢å¯å‘é€5æ¡æ¶ˆæ¯
âœ“ ç™»å½•åå†å²å¯¹è¯è‡ªåŠ¨åŒæ­¥
âœ“ è®¿å®¢æ•°æ®è¿ç§»æ— ä¸¢å¤±
âœ“ migrateToUser APIæ­£å¸¸å·¥ä½œ
```

**âš ï¸ Sprint 1 éªŒè¯æ£€æŸ¥ç‚¹ï¼ˆå‚è€ƒç¬¬å…­ç« ï¼‰:**
```
â”œâ”€â”€ [ ] å®Œæˆ 6.3 éªŒè¯æ£€æŸ¥æ¸…å•ï¼ˆä»£ç /åŠŸèƒ½/å®‰å…¨/æ€§èƒ½/å›å½’ï¼‰
â”œâ”€â”€ [ ] æ‰€æœ‰PRå·²Reviewå¹¶åˆå¹¶
â”œâ”€â”€ [ ] CIè‡ªåŠ¨åŒ–æµ‹è¯•å…¨éƒ¨é€šè¿‡
â”œâ”€â”€ [ ] Sprint Reviewæ¼”ç¤ºé€šè¿‡
â””â”€â”€ [ ] é—®é¢˜è¿½è¸ªæ¸…å•æ›´æ–°ï¼ˆP0 #3,#4 æ ‡è®°å®Œæˆï¼‰
```

---

### Sprint 2: Dashboard + å¿ƒæƒ…è¿½è¸ªï¼ˆç¬¬3å‘¨ï¼‰

**ç›®æ ‡**: Dashboardä½œä¸ºç™»å½•åé¦–é¡µï¼ŒåŒ…å«å¿ƒæƒ…è¿½è¸ªå…¥å£

```
åŠŸèƒ½åˆ‡ç‰‡ 2.1: Dashboardé‡æ„

é¡µé¢
â””â”€â”€ [ ] pages/dashboard.tsx
    â”œâ”€â”€ ä»Šæ—¥å¿ƒæƒ…å¡ç‰‡ï¼ˆé¡¶éƒ¨ï¼‰
    â”œâ”€â”€ ç´§æ€¥å†·é™æŒ‰é’®ï¼ˆé†’ç›®ä½ç½®ï¼Œçº¢è‰²è„‰åŠ¨ï¼‰
    â”œâ”€â”€ å¿«é€Ÿæ“ä½œç½‘æ ¼
    â””â”€â”€ æœ€è¿‘å¯¹è¯åˆ—è¡¨ï¼ˆçœŸå®æ•°æ®ï¼‰

ç»„ä»¶
â”œâ”€â”€ [ ] components/Dashboard/MoodCard.tsx
â”œâ”€â”€ [ ] components/Dashboard/QuickActions.tsx
â”œâ”€â”€ [ ] components/Dashboard/RecentChats.tsx
â””â”€â”€ [ ] components/Dashboard/EmergencyButton.tsx

å¯¼èˆªæ›´æ–°
â””â”€â”€ [ ] ç™»å½•åé»˜è®¤è·³è½¬åˆ°Dashboard

éªŒæ”¶æ ‡å‡†:
âœ“ Dashboardå¸ƒå±€å®Œæ•´
âœ“ å„æ¨¡å—æ˜¾ç¤ºçœŸå®æ•°æ®
âœ“ ç´§æ€¥æŒ‰é’®é†’ç›®å¯è§
```

```
åŠŸèƒ½åˆ‡ç‰‡ 2.2: å¿ƒæƒ…è¿½è¸ªå®Œæ•´åŠŸèƒ½

åç«¯ä»£ç†
â”œâ”€â”€ [ ] pages/api/mood/record.ts
â”œâ”€â”€ [ ] pages/api/mood/history.ts
â””â”€â”€ [ ] pages/api/mood/stats.ts

æœåŠ¡å±‚
â””â”€â”€ [ ] services/mood.ts
    â”œâ”€â”€ recordMood(mood, note?)
    â”œâ”€â”€ getHistory(range)
    â””â”€â”€ getStats()

çŠ¶æ€ç®¡ç†
â””â”€â”€ [ ] stores/moodStore.ts
    â”œâ”€â”€ todayMood: MoodRecord | null
    â”œâ”€â”€ history: MoodRecord[]
    â””â”€â”€ stats: MoodStats

ç»„ä»¶
â”œâ”€â”€ [ ] components/Mood/MoodPicker.tsx
â”‚   â”œâ”€â”€ 5ä¸ªè¡¨æƒ…é€‰æ‹©
â”‚   â””â”€â”€ å¯é€‰å¤‡æ³¨è¾“å…¥
â”‚
â”œâ”€â”€ [ ] components/Mood/MoodChart.tsx
â”‚   â”œâ”€â”€ npm install recharts
â”‚   â””â”€â”€ 7å¤©/30å¤©/6æœˆåˆ‡æ¢
â”‚
â””â”€â”€ [ ] components/Mood/MoodHistory.tsx

é¡µé¢
â””â”€â”€ [ ] pages/mood.tsx

éªŒæ”¶æ ‡å‡†:
âœ“ è®°å½•å¿ƒæƒ…åç«‹å³åæ˜ åœ¨å›¾è¡¨
âœ“ å›¾è¡¨æ•°æ®ä¸åç«¯ä¸€è‡´
âœ“ è§†å›¾åˆ‡æ¢æ­£å¸¸
```

**âš ï¸ Sprint 2 éªŒè¯æ£€æŸ¥ç‚¹ï¼ˆå‚è€ƒç¬¬å…­ç« ï¼‰:**
```
â”œâ”€â”€ [ ] å®Œæˆ 6.3 éªŒè¯æ£€æŸ¥æ¸…å•
â”œâ”€â”€ [ ] Dashboardå„ç»„ä»¶æµ‹è¯•é€šè¿‡
â”œâ”€â”€ [ ] å¿ƒæƒ…æ•°æ®ä¸åç«¯åŒæ­¥éªŒè¯
â”œâ”€â”€ [ ] Sprint Reviewæ¼”ç¤ºé€šè¿‡
â””â”€â”€ [ ] ç§»åŠ¨ç«¯é€‚é…æµ‹è¯•
```

---

### Sprint 3: æˆé•¿æ–¹æ¡ˆç³»ç»Ÿï¼ˆç¬¬4å‘¨ï¼‰

**ç›®æ ‡**: ä»å¯¹è¯ä¸­æå–å¹²é¢„å»ºè®®ï¼Œå½¢æˆæˆé•¿æ–¹æ¡ˆ

```
åŠŸèƒ½åˆ‡ç‰‡ 3.1: æˆé•¿æ–¹æ¡ˆåŸºç¡€

åç«¯ä»£ç†
â”œâ”€â”€ [ ] pages/api/plan/index.ts (GET/POST)
â”œâ”€â”€ [ ] pages/api/plan/generate.ts
â””â”€â”€ [ ] pages/api/plan/item/[id].ts

æœåŠ¡å±‚
â””â”€â”€ [ ] services/plan.ts
    â”œâ”€â”€ getPlan()
    â”œâ”€â”€ generateFromChat(conversationId)
    â”œâ”€â”€ starItem(itemId)
    â”œâ”€â”€ checkIn(itemId)
    â”œâ”€â”€ moveItem(itemId, category)
    â”œâ”€â”€ deleteItem(itemId)
    â””â”€â”€ exportPdf(itemIds)

çŠ¶æ€ç®¡ç†
â””â”€â”€ [ ] stores/planStore.ts
    â”œâ”€â”€ plan: ActionPlan
    â”œâ”€â”€ selectedCategory: PlanCategory | 'all'
    â””â”€â”€ actions

ç»„ä»¶
â”œâ”€â”€ [ ] components/Plan/CategoryTabs.tsx (7å¤§åˆ†ç±»)
â”œâ”€â”€ [ ] components/Plan/PlanCard.tsx (æ˜Ÿæ ‡/æ‰“å¡/åˆ é™¤)
â”œâ”€â”€ [ ] components/Plan/PlanList.tsx
â””â”€â”€ [ ] components/Plan/GenerateButton.tsx

é¡µé¢
â””â”€â”€ [ ] pages/plan.tsx

éªŒæ”¶æ ‡å‡†:
âœ“ èƒ½ä»å¯¹è¯ç”Ÿæˆæ–¹æ¡ˆ
âœ“ 7å¤§åˆ†ç±»è¿‡æ»¤æ­£å¸¸
âœ“ æ˜Ÿæ ‡/æ‰“å¡çŠ¶æ€æŒä¹…åŒ–
```

```
åŠŸèƒ½åˆ‡ç‰‡ 3.2: PDFå¯¼å‡º

åç«¯
â””â”€â”€ [ ] pages/api/plan/export.ts

ç»„ä»¶
â””â”€â”€ [ ] components/Plan/ExportModal.tsx
    â”œâ”€â”€ é€‰æ‹©è¦å¯¼å‡ºçš„é¡¹ç›®
    â”œâ”€â”€ é¢„è§ˆ
    â””â”€â”€ ä¸‹è½½/åˆ†äº«

éªŒæ”¶æ ‡å‡†:
âœ“ PDFåŒ…å«é€‰ä¸­çš„æ‰€æœ‰é¡¹ç›®
âœ“ ä¸‹è½½é“¾æ¥1å°æ—¶å†…æœ‰æ•ˆ
```

**âš ï¸ Sprint 3 éªŒè¯æ£€æŸ¥ç‚¹ï¼ˆå‚è€ƒç¬¬å…­ç« ï¼‰:**
```
â”œâ”€â”€ [ ] å®Œæˆ 6.3 éªŒè¯æ£€æŸ¥æ¸…å•
â”œâ”€â”€ [ ] 7å¤§åˆ†ç±»æ•°æ®è¿‡æ»¤é€»è¾‘æµ‹è¯•
â”œâ”€â”€ [ ] PDFå¯¼å‡ºå†…å®¹å®Œæ•´æ€§éªŒè¯
â”œâ”€â”€ [ ] ä¸å°ç¨‹åºåŠŸèƒ½å¯¹æ¯”éªŒè¯
â””â”€â”€ [ ] Sprint Reviewæ¼”ç¤ºé€šè¿‡
```

---

### Sprint 4: ç´§æ€¥å†·é™ + åˆè§„ï¼ˆç¬¬5å‘¨ï¼‰

**ç›®æ ‡**: ç´§æ€¥å†·é™å¼•å¯¼åŠŸèƒ½ï¼Œæ³•å¾‹åˆè§„é¡µé¢

```
åŠŸèƒ½åˆ‡ç‰‡ 4.1: ç´§æ€¥å†·é™å¼•å¯¼

ç»„ä»¶
â”œâ”€â”€ [ ] components/Calm/BreathingGuide.tsx
â”‚   â”œâ”€â”€ 4-4-4-4å‘¼å¸åŠ¨ç”»
â”‚   â””â”€â”€ å¾ªç¯è®¡æ•°æ˜¾ç¤º
â”‚
â”œâ”€â”€ [ ] components/Calm/MeditationPlayer.tsx
â”‚   â”œâ”€â”€ èƒŒæ™¯éŸ³ä¹æ’­æ”¾
â”‚   â””â”€â”€ è¿›åº¦æ¡
â”‚
â””â”€â”€ [ ] components/Calm/CalmProgress.tsx

é¡µé¢
â””â”€â”€ [ ] pages/calm.tsx
    â”œâ”€â”€ å‡†å¤‡é˜¶æ®µ (30ç§’)
    â”œâ”€â”€ å‘¼å¸é˜¶æ®µ (4å¾ªç¯)
    â”œâ”€â”€ å†¥æƒ³é˜¶æ®µ
    â””â”€â”€ å®Œæˆåé¦ˆ

èµ„æº
â””â”€â”€ [ ] public/audio/calm-music.mp3

å…¥å£
â”œâ”€â”€ [ ] Dashboardç´§æ€¥æŒ‰é’®
â””â”€â”€ [ ] å…¨å±€æ‚¬æµ®æŒ‰é’®ï¼ˆå¯é€‰ï¼‰

éªŒæ”¶æ ‡å‡†:
âœ“ å‘¼å¸åŠ¨ç”»æµç•…
âœ“ éŸ³ä¹å¾ªç¯æ’­æ”¾æ— ç¼
```

```
åŠŸèƒ½åˆ‡ç‰‡ 4.2: åˆè§„é¡µé¢ (ä¸Šçº¿é˜»æ–­é¡¹)

é¡µé¢
â”œâ”€â”€ [ ] pages/privacy.tsx (éšç§æ”¿ç­–)
â”œâ”€â”€ [ ] pages/terms.tsx (æœåŠ¡æ¡æ¬¾)
â””â”€â”€ [ ] pages/settings.tsx (ç”¨æˆ·è®¾ç½®)
    â”œâ”€â”€ æ•°æ®åˆ é™¤åŠŸèƒ½
    â””â”€â”€ æ•°æ®å¯¼å‡ºåŠŸèƒ½

ç»„ä»¶
â”œâ”€â”€ [ ] components/UI/CookieConsent.tsx
â”‚   â”œâ”€â”€ é¦–æ¬¡è®¿é—®å¼¹å‡º
â”‚   â”œâ”€â”€ æ¥å—/æ‹’ç»é€‰é¡¹
â”‚   â””â”€â”€ è®°ä½é€‰æ‹©
â”‚
â””â”€â”€ [ ] components/UI/AgeGate.tsx
    â”œâ”€â”€ 13å²ä»¥ä¸‹éœ€å®¶é•¿åŒæ„
    â””â”€â”€ COPPAåˆè§„

æ³•å¾‹æ–‡æœ¬
â””â”€â”€ [ ] éœ€æ³•åŠ¡å®¡æ ¸
    â”œâ”€â”€ æ•°æ®æ”¶é›†è¯´æ˜
    â”œâ”€â”€ å„¿ç«¥éšç§ä¿æŠ¤å£°æ˜
    â””â”€â”€ Cookieä½¿ç”¨è¯´æ˜

éªŒæ”¶æ ‡å‡†:
âœ“ Cookieå¼¹çª—ç¬¦åˆGDPR
âœ“ éšç§æ”¿ç­–é“¾æ¥åœ¨Footer
âœ“ æ¶‰åŠå„¿ç«¥æ•°æ®æ—¶æœ‰æç¤º
```

**âš ï¸ Sprint 4 éªŒè¯æ£€æŸ¥ç‚¹ï¼ˆå‚è€ƒç¬¬å…­ç« ï¼‰:**
```
â”œâ”€â”€ [ ] å®Œæˆ 6.3 éªŒè¯æ£€æŸ¥æ¸…å•
â”œâ”€â”€ [ ] å‘¼å¸åŠ¨ç”»60fpsæµç•…åº¦æµ‹è¯•
â”œâ”€â”€ [ ] éŸ³é¢‘æ’­æ”¾å…¼å®¹æ€§æµ‹è¯•ï¼ˆiOS/Android/Desktopï¼‰
â”œâ”€â”€ [ ] æ³•åŠ¡ç¡®è®¤éšç§æ”¿ç­–å†…å®¹
â”œâ”€â”€ [ ] GDPR/COPPAåˆè§„æ£€æŸ¥
â”œâ”€â”€ [ ] é—®é¢˜è¿½è¸ªæ¸…å•æ›´æ–°ï¼ˆP0 #5,#6,#7 æ ‡è®°å®Œæˆï¼‰
â””â”€â”€ [ ] Sprint Reviewæ¼”ç¤ºé€šè¿‡
```

---

### Sprint 5: æ€§èƒ½ä¼˜åŒ– + æµ‹è¯•ï¼ˆç¬¬6å‘¨ï¼‰

**ç›®æ ‡**: æ€§èƒ½ä¼˜åŒ–ï¼Œæµ‹è¯•è¦†ç›–ï¼Œä¸Šçº¿å‡†å¤‡

```
æ€§èƒ½ä¼˜åŒ–ä»»åŠ¡:

5.1 ä»£ç åˆ†å‰²
â”œâ”€â”€ [ ] GuestOnboarding åŠ¨æ€å¯¼å…¥
â”‚   â””â”€â”€ const GuestOnboarding = dynamic(() => import(...))
â”‚
â”œâ”€â”€ [ ] SmartDrawer åŠ¨æ€å¯¼å…¥
â”œâ”€â”€ [ ] MoodChart åŠ¨æ€å¯¼å…¥
â””â”€â”€ [ ] ç›®æ ‡: é¦–å±JS < 300KB

5.2 ç»„ä»¶æ‹†åˆ† (é™ä½å•æ–‡ä»¶å¤§å°)
â”œâ”€â”€ [ ] GuestOnboarding.tsx (865è¡Œ â†’ <300è¡Œ)
â”‚   â”œâ”€â”€ components/Chat/Onboarding/BirthdaySelector.tsx
â”‚   â”œâ”€â”€ components/Chat/Onboarding/ChallengeSelector.tsx
â”‚   â””â”€â”€ components/Chat/Onboarding/SuggestionList.tsx
â”‚
â”œâ”€â”€ [ ] chat.tsx (310è¡Œ â†’ <150è¡Œ)
â”‚   â””â”€â”€ æå–ä¸šåŠ¡é€»è¾‘åˆ° hooks/useChatPage.ts
â”‚
â””â”€â”€ [ ] ChatInput.tsx (395è¡Œ â†’ <200è¡Œ)
    â””â”€â”€ æå–æ–‡ä»¶å¤„ç†åˆ° hooks/useFileUpload.ts

5.3 å…¶ä»–ä¼˜åŒ–
â”œâ”€â”€ [ ] å›¾ç‰‡ä¼˜åŒ– (next/imageæ›¿æ¢img)
â”œâ”€â”€ [ ] æ¶ˆæ¯åˆ—è¡¨è™šæ‹ŸåŒ– (react-window, 100+æ¶ˆæ¯åœºæ™¯)
â”œâ”€â”€ [ ] è¯·æ±‚ç¼“å­˜ (SWRæˆ–React Query)
â””â”€â”€ [ ] é¦–å±LCPä¼˜åŒ– (ç›®æ ‡ < 2.5s)
```

```
æµ‹è¯•ä»»åŠ¡:

5.4 å•å…ƒæµ‹è¯•
â”œâ”€â”€ [ ] services/*.ts (Jest)
â”œâ”€â”€ [ ] utils/*.ts (Jest)
â””â”€â”€ [ ] è¦†ç›–ç‡ç›®æ ‡: >60%

5.5 ç»„ä»¶æµ‹è¯•
â”œâ”€â”€ [ ] ChatInput (React Testing Library)
â”œâ”€â”€ [ ] MoodPicker
â””â”€â”€ [ ] PlanCard

5.6 E2Eæµ‹è¯•
â”œâ”€â”€ [ ] å¯¹è¯æµç¨‹ (Playwright)
â”œâ”€â”€ [ ] ç™»å½•æµç¨‹
â””â”€â”€ [ ] è®¿å®¢è¿ç§»æµç¨‹
```

```
ç›‘æ§ä¸ä¸Šçº¿:

5.7 ç›‘æ§
â”œâ”€â”€ [ ] Vercel Analytics
â”œâ”€â”€ [ ] Sentryé”™è¯¯ç›‘æ§
â””â”€â”€ [ ] è‡ªå®šä¹‰äº‹ä»¶è¿½è¸ª

5.8 ä¸Šçº¿æ¸…å•
â”œâ”€â”€ [ ] ç¯å¢ƒå˜é‡é…ç½®æ£€æŸ¥
â”œâ”€â”€ [ ] åŸŸåå’ŒSSL
â”œâ”€â”€ [ ] CDNé…ç½®
â”œâ”€â”€ [ ] å¤‡ä»½ç­–ç•¥
â””â”€â”€ [ ] Lighthouseå®¡è®¡ (ç›®æ ‡ >90åˆ†)

éªŒæ”¶æ ‡å‡†:
âœ“ LCP < 2.5s
âœ“ Performance > 90
âœ“ æµ‹è¯•è¦†ç›– > 60%
âœ“ æ— P0çº§åˆ«bug
```

**âš ï¸ Sprint 5 éªŒè¯æ£€æŸ¥ç‚¹ - ä¸Šçº¿å‰å®Œæ•´éªŒè¯ï¼ˆå‚è€ƒç¬¬å…­ç« ï¼‰:**
```
ä»£ç éªŒè¯:
â”œâ”€â”€ [ ] npm run lint é›¶è­¦å‘Š
â”œâ”€â”€ [ ] npm run build é›¶é”™è¯¯
â”œâ”€â”€ [ ] npm audit æ— é«˜å±æ¼æ´
â””â”€â”€ [ ] æ‰€æœ‰TypeScript strictæ¨¡å¼é€šè¿‡

æµ‹è¯•éªŒè¯:
â”œâ”€â”€ [ ] å•å…ƒæµ‹è¯•è¦†ç›– > 60%
â”œâ”€â”€ [ ] E2Eæ ¸å¿ƒæµç¨‹å…¨éƒ¨é€šè¿‡
â””â”€â”€ [ ] å›å½’æµ‹è¯•æ— é—®é¢˜

æ€§èƒ½éªŒè¯:
â”œâ”€â”€ [ ] Lighthouse Performance > 90
â”œâ”€â”€ [ ] LCP < 2.5s
â”œâ”€â”€ [ ] é¦–å±JS < 300KB
â””â”€â”€ [ ] ç§»åŠ¨ç«¯3Gç½‘ç»œå¯ç”¨

å®‰å…¨éªŒè¯:
â”œâ”€â”€ [ ] å®‰å…¨Headerså…¨éƒ¨å­˜åœ¨
â”œâ”€â”€ [ ] æ— XSS/CSRFæ¼æ´
â””â”€â”€ [ ] æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨

åˆè§„éªŒè¯:
â”œâ”€â”€ [ ] Cookieå¼¹çª—æ­£å¸¸
â”œâ”€â”€ [ ] éšç§æ”¿ç­–å¯è®¿é—®
â”œâ”€â”€ [ ] å¹´é¾„éªŒè¯æ­£å¸¸
â””â”€â”€ [ ] æ•°æ®åˆ é™¤åŠŸèƒ½æ­£å¸¸

æœ€ç»ˆç¡®è®¤:
â”œâ”€â”€ [ ] é—®é¢˜è¿½è¸ªæ¸…å•æ‰€æœ‰P0/P1å®Œæˆ
â”œâ”€â”€ [ ] ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
â”œâ”€â”€ [ ] åŸŸå/SSL/CDNå°±ç»ª
â””â”€â”€ [ ] ä¸Šçº¿å®¡æ‰¹é€šè¿‡
```

---

## å››ã€APIå¯¹æ¥æ˜ å°„è¡¨

> **æ³¨**: Sprint 1.1 é‡‡ç”¨ DeepSeek API ç›´è¿æ–¹æ¡ˆï¼ŒèŠå¤©åŠŸèƒ½ç‹¬ç«‹äºå°ç¨‹åºåç«¯

| ç½‘é¡µç‰ˆåŠŸèƒ½ | ç½‘é¡µç‰ˆAPI | åç«¯ | è¯´æ˜ |
|-----------|----------|------|------|
| å‘é€æ¶ˆæ¯ | POST /api/chat/stream | DeepSeek API | âœ… ç›´è¿ï¼ŒSSEæµå¼ |
| åœæ­¢ç”Ÿæˆ | POST /api/chat/stop | æœ¬åœ° AbortController | âœ… å‰ç«¯æ§åˆ¶ |
| ä¼šè¯åˆ—è¡¨ | GET /api/conversations | GET /conversations | 100% |
| åˆ›å»ºä¼šè¯ | POST /api/conversations | POST /conversations | 100% |
| æ¶ˆæ¯å†å² | GET /api/messages/[id] | GET /messages/:threadId | 100% |
| å¿ƒæƒ…è®°å½• | POST /api/mood/record | POST /api/mood/record | 100% |
| å¿ƒæƒ…å†å² | GET /api/mood/history | GET /api/mood/history | 100% |
| æˆé•¿æ–¹æ¡ˆ | GET /api/plan | GET /api/action-plan | 100% |
| ç”Ÿæˆæ–¹æ¡ˆ | POST /api/plan/generate | POST /api/action-plan/save-from-chat-stream | 100% |
| å¯¼å‡ºPDF | POST /api/plan/export | POST /api/action-plan/export-pdf | 100% |
| é…é¢çŠ¶æ€ | GET /api/quota | GET /api/quota/status | 100% |
| **ç”¨æˆ·ç»Ÿè®¡** | GET /api/user-stats | GET /api/stats/users | 100% |
| è®¿å®¢è¿ç§» | POST /api/user/migrate-guest | æ–°å»ºç«¯ç‚¹ | æ–°å¢ |

**è®¤è¯é€‚é…å±‚**:

```typescript
// pages/api/[...proxy].ts
export default async function handler(req, res) {
  const session = await getServerSession(req, res, authOptions);

  let userId: string;
  if (session?.user?.id) {
    userId = session.user.id;
  } else if (req.cookies['guest_session']) {
    userId = `guest_${req.cookies['guest_session']}`;
  } else {
    return res.status(401).json({ error: 'Unauthorized' });
  }

  const body = { ...req.body, userId };

  const response = await fetch(`${API_BASE}${req.url}`, {
    method: req.method,
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(body),
  });

  const data = await response.json();
  return res.status(response.status).json(data);
}
```

---

## äº”ã€éªŒæ”¶æ ‡å‡†æ±‡æ€»

| Sprint | åŠŸèƒ½ | éªŒæ”¶æ ‡å‡† |
|--------|------|---------|
| S0 | åŸºç¡€è®¾æ–½+å®‰å…¨ | buildé€šè¿‡ï¼Œlintæ— è­¦å‘Šï¼ŒAPIè¿é€šï¼Œå®‰å…¨Headerså­˜åœ¨ |
| S1 | å¯¹è¯å®Œæ•´ | çœŸå®å¯¹è¯ï¼Œå†å²æŒä¹…ï¼Œè®¿å®¢è¿ç§»ï¼Œæ— é‡å¤è§¦å‘bug |
| S2 | Dashboard+å¿ƒæƒ… | å¸ƒå±€å®Œæ•´ï¼Œå¿ƒæƒ…å›¾è¡¨æ­£ç¡®ï¼Œæ•°æ®åŒæ­¥ |
| S3 | æˆé•¿æ–¹æ¡ˆ | ç”Ÿæˆ/ç¼–è¾‘/å¯¼å‡ºPDFæ­£å¸¸ï¼Œ7åˆ†ç±»æ­£å¸¸ |
| S4 | å†·é™+åˆè§„ | åŠ¨ç”»æµç•…ï¼Œæ³•å¾‹é¡µé¢å®Œæ•´ï¼ŒCookieå¼¹çª—å­˜åœ¨ |
| S5 | ä¼˜åŒ–æµ‹è¯• | LCP<2.5sï¼ŒPerformance>90ï¼Œæµ‹è¯•è¦†ç›–>60% |

---

## å…­ã€éªŒè¯è§„èŒƒï¼ˆè¡Œä¸šæ ‡å‡†ï¼‰

### 6.1 éªŒè¯å±‚çº§ä½“ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        éªŒè¯é‡‘å­—å¡”                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                        â”‚  E2E    â”‚  â† å°‘é‡å…³é”®æµç¨‹               â”‚
â”‚                        â”‚  æµ‹è¯•   â”‚                              â”‚
â”‚                     â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”                           â”‚
â”‚                     â”‚   é›†æˆæµ‹è¯•     â”‚  â† APIç«¯ç‚¹éªŒè¯            â”‚
â”‚                  â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”                        â”‚
â”‚                  â”‚      å•å…ƒæµ‹è¯•        â”‚  â† å¤§é‡ã€å¿«é€Ÿã€è¦†ç›–å¹¿   â”‚
â”‚               â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”                     â”‚
â”‚               â”‚        é™æ€æ£€æŸ¥           â”‚  â† Lint + TypeScript â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 æ¯ä¸ªSprintçš„éªŒè¯æµç¨‹

| é˜¶æ®µ | éªŒè¯æ´»åŠ¨ | è´£ä»»äºº | å·¥å…·/æ–¹æ³• | æ—¶æœº |
|------|---------|--------|----------|------|
| **å¼€å‘ä¸­** | å¼€å‘è€…è‡ªæµ‹ | å¼€å‘è€… | æœ¬åœ°è¿è¡Œã€æ‰‹åŠ¨æµ‹è¯• | æ¯ä¸ªä»»åŠ¡å®Œæˆæ—¶ |
| **æäº¤å‰** | é™æ€æ£€æŸ¥ | è‡ªåŠ¨åŒ– | ESLint + TypeScript | git commit hook |
| **PRé˜¶æ®µ** | ä»£ç Review | å›¢é˜Ÿæˆå‘˜ | GitHub PR Review | åˆå¹¶å‰ |
| **CIé˜¶æ®µ** | è‡ªåŠ¨åŒ–æµ‹è¯• | CI/CD | Jest + Playwright | æ¯æ¬¡push |
| **Sprintæœ«** | åŠŸèƒ½éªŒæ”¶ | PM/è®¾è®¡ | å¯¹ç…§éªŒæ”¶æ ‡å‡†æ¼”ç¤º | Sprint Review |
| **å‘å¸ƒå‰** | å›å½’æµ‹è¯• | QA | æ ¸å¿ƒæµç¨‹å…¨é‡æµ‹è¯• | å‘å¸ƒå‰1å¤© |

### 6.3 éªŒè¯æ£€æŸ¥æ¸…å•æ¨¡æ¿

æ¯ä¸ªSprintå®Œæˆæ—¶ï¼Œéœ€é€é¡¹ç¡®è®¤ï¼š

```markdown
## Sprint X éªŒè¯æ£€æŸ¥æ¸…å•

### ä»£ç å±‚é¢
- [ ] `npm run lint` æ— è­¦å‘Š
- [ ] `npm run build` æ— é”™è¯¯
- [ ] TypeScript æ— ç±»å‹é”™è¯¯
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡ç‡ 100%
- [ ] æ–°å¢ä»£ç æœ‰å¯¹åº”æµ‹è¯•

### åŠŸèƒ½å±‚é¢
- [ ] éªŒæ”¶æ ‡å‡†é€é¡¹ç¡®è®¤
- [ ] è¾¹ç•Œæƒ…å†µå·²æµ‹è¯•
- [ ] é”™è¯¯å¤„ç†æ­£å¸¸
- [ ] ç§»åŠ¨ç«¯é€‚é…æ­£å¸¸

### å®‰å…¨å±‚é¢
- [ ] æ— ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯
- [ ] APIè°ƒç”¨æœ‰é”™è¯¯å¤„ç†
- [ ] ç”¨æˆ·è¾“å…¥æœ‰éªŒè¯

### æ€§èƒ½å±‚é¢
- [ ] æ— æ˜æ˜¾å¡é¡¿
- [ ] ç½‘ç»œè¯·æ±‚åˆç†
- [ ] æ— å†…å­˜æ³„æ¼è¿¹è±¡

### å›å½’æµ‹è¯•
- [ ] å·²æœ‰åŠŸèƒ½æœªå—å½±å“
- [ ] æ ¸å¿ƒæµç¨‹ä»æ­£å¸¸
```

### 6.4 è‡ªåŠ¨åŒ–éªŒè¯é…ç½®

```javascript
// package.json scripts
{
  "scripts": {
    "lint": "eslint . --ext .ts,.tsx",
    "type-check": "tsc --noEmit",
    "test": "jest",
    "test:coverage": "jest --coverage",
    "test:e2e": "playwright test",
    "validate": "npm run lint && npm run type-check && npm run test"
  }
}

// .husky/pre-commit (Git Hook)
#!/bin/sh
npm run lint
npm run type-check
```

```yaml
# .github/workflows/ci.yml
name: CI
on: [push, pull_request]
jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
      - run: npm ci
      - run: npm run lint
      - run: npm run type-check
      - run: npm run test:coverage
      - run: npm run build
```

### 6.5 éªŒè¯å·¥å…·æ¸…å•

| éªŒè¯ç±»å‹ | å·¥å…· | ç”¨é€” |
|---------|------|------|
| ä»£ç é£æ ¼ | ESLint + Prettier | ä»£ç ä¸€è‡´æ€§ |
| ç±»å‹æ£€æŸ¥ | TypeScript (strict) | ç¼–è¯‘æ—¶é”™è¯¯ |
| å•å…ƒæµ‹è¯• | Jest | å‡½æ•°/ç»„ä»¶æµ‹è¯• |
| ç»„ä»¶æµ‹è¯• | React Testing Library | UIç»„ä»¶äº¤äº’ |
| E2Eæµ‹è¯• | Playwright | ç”¨æˆ·æµç¨‹ |
| æ€§èƒ½æ£€æµ‹ | Lighthouse CI | æ€§èƒ½æŒ‡æ ‡ |
| å®‰å…¨æ‰«æ | npm audit | ä¾èµ–æ¼æ´ |
| è¦†ç›–ç‡ | Jest --coverage | æµ‹è¯•è¦†ç›– |

### 6.6 SprintéªŒè¯æ—¶é—´èŠ‚ç‚¹

```
Sprint å‘¨æœŸï¼ˆ1å‘¨ï¼‰
â”œâ”€â”€ Day 1-4: å¼€å‘
â”‚   â”œâ”€â”€ æ¯ä¸ªä»»åŠ¡å®Œæˆ â†’ å¼€å‘è€…è‡ªæµ‹
â”‚   â””â”€â”€ æ¯æ¬¡æäº¤ â†’ Lint + Type Check
â”‚
â”œâ”€â”€ Day 5: éªŒè¯
â”‚   â”œâ”€â”€ ä¸Šåˆ: åŠŸèƒ½è‡ªæµ‹ + ä¿®å¤
â”‚   â”œâ”€â”€ ä¸‹åˆ: ä»£ç Review + åˆå¹¶
â”‚   â””â”€â”€ CI: è‡ªåŠ¨åŒ–æµ‹è¯•å…¨é‡è¿è¡Œ
â”‚
â””â”€â”€ Day 5 æœ«: Sprint Review
    â”œâ”€â”€ å¯¹ç…§éªŒæ”¶æ ‡å‡†æ¼”ç¤º
    â”œâ”€â”€ å¡«å†™éªŒè¯æ£€æŸ¥æ¸…å•
    â””â”€â”€ ç¡®è®¤ä¸‹ä¸€Sprintè®¡åˆ’
```

### 6.7 éªŒè¯æœªé€šè¿‡çš„å¤„ç†

| é—®é¢˜çº§åˆ« | å®šä¹‰ | å¤„ç†æ–¹å¼ |
|---------|------|---------|
| **é˜»æ–­** | æ ¸å¿ƒåŠŸèƒ½ä¸å¯ç”¨ | ç«‹å³ä¿®å¤ï¼Œä¸åˆå¹¶ |
| **ä¸¥é‡** | åŠŸèƒ½ç¼ºé™·ä½†å¯ç»•è¿‡ | å½“å‰Sprintä¿®å¤ |
| **ä¸€èˆ¬** | ä½“éªŒé—®é¢˜ | è®°å½•ï¼Œä¸‹Sprintå¤„ç† |
| **è½»å¾®** | ä¼˜åŒ–å»ºè®® | è®°å½•åˆ°backlog |

---

## ä¸ƒã€é—®é¢˜è¿½è¸ªæ¸…å•

> æ³¨ï¼šé—®é¢˜ä¿®å¤åéœ€ç»è¿‡ç¬¬å…­ç« éªŒè¯æµç¨‹ç¡®è®¤

### P0 - ä¸Šçº¿é˜»æ–­é¡¹ï¼ˆå¿…é¡»å®Œæˆï¼‰

| # | é—®é¢˜ | ç±»åˆ« | Sprint | çŠ¶æ€ |
|---|------|------|--------|------|
| 1 | dangerouslySetInnerHTML XSS | å®‰å…¨ | S0 | [x] âœ… mockup.tsx å·²åˆ é™¤ |
| 2 | NextAuthé…ç½®ä¸å®Œæ•´ | å®‰å…¨ | S0 | [x] âœ… å·²å®Œå–„ |
| 3 | Mockæ•°æ®æ›¿ä»£çœŸå®API | åŠŸèƒ½ | S1.1 | [x] âœ… DeepSeek ç›´è¿ |
| 4 | migrateToUser APIä¸å­˜åœ¨ | åŠŸèƒ½ | S1.3 | [ ] |
| 5 | CookieåŒæ„æ¨ªå¹… | åˆè§„ | S4 | [ ] |
| 6 | éšç§æ”¿ç­–é¡µé¢ | åˆè§„ | S4 | [ ] |
| 7 | æœåŠ¡æ¡æ¬¾é¡µé¢ | åˆè§„ | S4 | [ ] |

### P1 - é‡è¦é—®é¢˜

| # | é—®é¢˜ | ç±»åˆ« | Sprint | çŠ¶æ€ |
|---|------|------|--------|------|
| 8 | è·¯ç”±å‚æ•°é‡å¤è§¦å‘ | åŠŸèƒ½ | S1.1 | [x] âœ… modeHandledRef ä¿®å¤ |
| 9 | æŠ½å±‰æ“ä½œæ— å®é™…åŠŸèƒ½ | åŠŸèƒ½ | S1.2 | [ ] |
| 10 | æ¶ˆæ¯å†å²ä¸å®Œæ•´ | åŠŸèƒ½ | S1.2 | [ ] |
| 11 | å®‰å…¨Headers | å®‰å…¨ | S0 | [x] âœ… |
| 12 | é‡å¤å‡½æ•°æå– | æ¶æ„ | S0 | [x] âœ… |
| 13 | ç±»å‹å®šä¹‰ç»Ÿä¸€ | æ¶æ„ | S0 | [x] âœ… |
| 14 | console.logæœªç§»é™¤ | å®‰å…¨ | S1.1 | [x] âœ… å·²ç§»é™¤ |

### P2 - ä¼˜åŒ–é¡¹

| # | é—®é¢˜ | ç±»åˆ« | Sprint | çŠ¶æ€ |
|---|------|------|--------|------|
| 15 | GuestOnboardingè¿‡å¤§ | æ€§èƒ½ | S5 | [ ] |
| 16 | ä»£ç åˆ†å‰² | æ€§èƒ½ | S5 | [ ] |
| 17 | æ¶ˆæ¯åˆ—è¡¨è™šæ‹ŸåŒ– | æ€§èƒ½ | S5 | [ ] |
| 18 | å›¾ç‰‡ä¼˜åŒ– | æ€§èƒ½ | S5 | [ ] |
| 19 | æµ‹è¯•è¦†ç›– | è´¨é‡ | S5 | [ ] |
| 20 | ç”¨æˆ·æ•°æ®åˆ é™¤åŠŸèƒ½ | åˆè§„ | S4 | [ ] |

---

## å…«ã€é£é™©ä¸ä¾èµ–

| é£é™© | æ¦‚ç‡ | å½±å“ | ç¼“è§£ |
|------|------|------|------|
| åç«¯APIä¸å…¼å®¹ | ä½ | é«˜ | Sprint 0æµ‹è¯•æ‰€æœ‰ç«¯ç‚¹ |
| è®¤è¯æ˜ å°„é—®é¢˜ | ä¸­ | é«˜ | è®¾è®¡è®¤è¯é€‚é…å±‚ |
| æ€§èƒ½é—®é¢˜ | ä¸­ | ä¸­ | Sprint 5ä¸“é¡¹ä¼˜åŒ– |
| åˆè§„å®¡æ ¸ä¸è¿‡ | ä¸­ | é«˜ | æå‰å’¨è¯¢æ³•åŠ¡ |
| COPPAå„¿ç«¥æ•°æ®é£é™© | ä¸­ | é«˜ | æ·»åŠ å¹´é¾„éªŒè¯å’Œå®¶é•¿åŒæ„ |

**å¤–éƒ¨ä¾èµ–**:
- å°ç¨‹åºåç«¯APIå¯ç”¨ä¸”ç¨³å®š
- Verceléƒ¨ç½²ç¯å¢ƒæ­£å¸¸
- æ³•åŠ¡å®¡æ ¸éšç§æ”¿ç­–

---

## ä¹ã€ç¯å¢ƒå˜é‡æ¸…å•

```env
# å¿…éœ€ - è®¤è¯
NEXTAUTH_URL=https://your-domain.com
NEXTAUTH_SECRET=your-secret-generated-with-openssl

# å¿…éœ€ - OAuth
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# å¿…éœ€ - AI Backend (DeepSeek ç›´è¿)
# è·å– API Key: https://platform.deepseek.com/
DEEPSEEK_API_KEY=sk-xxxxx           # æœåŠ¡ç«¯ç¯å¢ƒå˜é‡ï¼Œä¸æš´éœ²ç»™å‰ç«¯
DEEPSEEK_API_BASE=https://api.deepseek.com
DEEPSEEK_MODEL=deepseek-chat        # æˆ– deepseek-coder

# å¯é€‰ - åç«¯APIï¼ˆç”¨äºç”¨æˆ·ç»Ÿè®¡ç­‰åŠŸèƒ½ï¼‰
NEXT_PUBLIC_API_URL=https://api.xingbanai.cn

# å¯é€‰ - é‚®ä»¶è®¢é˜…ï¼ˆä»…ç”¨äºwaitliståŠŸèƒ½ï¼Œæ­£å¼Landing Pageä¸éœ€è¦ï¼‰
# æ³¨ï¼šLanding Pageçš„"families empowered"è®¡æ•°æ¥è‡ªåç«¯ç”¨æˆ·ç»Ÿè®¡API
# MAILCHIMP_API_KEY=
# MAILCHIMP_AUDIENCE_ID=
# MAILCHIMP_SERVER_PREFIX=

# å¯é€‰ - ç›‘æ§
SENTRY_DSN=
VERCEL_ANALYTICS_ID=
```

**å®‰å…¨è¯´æ˜**:
- `DEEPSEEK_API_KEY` ä»…åœ¨æœåŠ¡ç«¯ä½¿ç”¨ï¼ˆpages/api/ï¼‰ï¼Œä¸ä¼šæš´éœ²ç»™æµè§ˆå™¨
- `.env.local` å·²åŠ å…¥ `.gitignore`ï¼Œä¸ä¼šæäº¤åˆ°ä»£ç ä»“åº“
- ç”Ÿäº§ç¯å¢ƒé€šè¿‡ Vercel ç¯å¢ƒå˜é‡é…ç½®

---

## åã€æ¶æ„è§„èŒƒæ€§ç¡®è®¤

### è¯„ä¼°ç»“æœ

| è¯„ä¼°ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|---------|------|------|
| **è¡Œä¸šè§„èŒƒç¬¦åˆåº¦** | 9/10 | ç¬¦åˆNext.jsæœ€ä½³å®è·µ |
| **ä»£ç ç»„ç»‡** | 9/10 | æ¸…æ™°çš„åˆ†å±‚æ¶æ„ |
| **å¯ç»´æŠ¤æ€§** | 9/10 | èŒè´£åˆ†ç¦»ï¼Œæ˜“äºæ‰©å±• |
| **å®‰å…¨æ€§** | 8/10 | æœ‰å®‰å…¨è§„èŒƒï¼Œéœ€ä¸¥æ ¼æ‰§è¡Œ |
| **æ€§èƒ½** | 8/10 | æœ‰ä¼˜åŒ–è®¡åˆ’ |
| **åˆè§„æ€§** | 7/10 | æœ‰æ¸…å•ï¼Œéœ€æ³•åŠ¡é…åˆ |

### ä¸è¡Œä¸šæ ‡å‡†å¯¹æ¯”

| å¯¹æ¯”é¡¹ | è¡Œä¸šæ ‡å‡† | æˆ‘ä»¬çš„æ–¹æ¡ˆ | ç¬¦åˆåº¦ |
|--------|---------|-----------|-------|
| **å‰ç«¯æ¡†æ¶** | Next.js/Remix | Next.js 16 | âœ… 100% |
| **çŠ¶æ€ç®¡ç†** | Zustand/Redux/Jotai | Zustand | âœ… 100% |
| **APIå±‚æ¶æ„** | æœåŠ¡å±‚å°è£… | ApiClient + Services | âœ… 100% |
| **ç±»å‹ç³»ç»Ÿ** | TypeScript strict | TypeScript strict | âœ… 100% |
| **è®¤è¯æ–¹æ¡ˆ** | NextAuth/Clerk | NextAuth | âœ… 100% |
| **åç«¯å¤ç”¨** | BFFä»£ç†å±‚ | API Routesä»£ç† | âœ… 100% |
| **éƒ¨ç½²å¹³å°** | Vercel/Netlify | Vercel | âœ… 100% |

### æœ€ç»ˆç»“è®º

**âœ… æ¶æ„ç¬¦åˆè¡Œä¸šè§„èŒƒä¸”æ˜¯æœ€é«˜æ•ˆå®‰å…¨çš„æ–¹æ¡ˆ**

| æ ‡å‡† | ç»“è®º |
|------|------|
| **è¡Œä¸šè§„èŒƒ** | âœ… Next.js + TypeScript + Zustand ä¸»æµæŠ€æœ¯æ ˆ |
| **æœ€é«˜æ•ˆ** | âœ… åç«¯100%å¤ç”¨ï¼Œå‚ç›´åˆ‡ç‰‡å¼€å‘ï¼Œæ— å†—ä½™ |
| **å®‰å…¨** | âœ… å®Œæ•´å®‰å…¨è§„èŒƒï¼Œå…³é”®é—®é¢˜å·²è¯†åˆ«å¹¶å®‰æ’ä¿®å¤ |

**å”¯ä¸€å¾…è§£å†³**: åˆè§„å±‚é¢éœ€æ³•åŠ¡é…åˆå®¡æ ¸éšç§æ”¿ç­–å’Œå„¿ç«¥æ•°æ®å¤„ç†å£°æ˜ã€‚

---

> **æ–‡æ¡£ç‰ˆæœ¬**: 3.5ï¼ˆå®Œæ•´ç‰ˆï¼‰
> **æ›´æ–°æ—¥æœŸ**: 2026-01-26
> **å®¡æŸ¥çŠ¶æ€**: âœ… å››æ–¹é¢å®¡æŸ¥å®Œæˆ
> **éªŒè¯è§„èŒƒ**: âœ… å·²æ·»åŠ è¡Œä¸šæ ‡å‡†éªŒè¯æµç¨‹ï¼ˆç¬¬å…­ç« ï¼‰+ æ¯ä¸ªSprintéªŒè¯æ£€æŸ¥ç‚¹
> **å˜æ›´è¯´æ˜**:
> - v3.5: Sprint 1.1 å®Œæˆ - DeepSeek API ç›´è¿é›†æˆã€ç¯å¢ƒå˜é‡é…ç½®ã€å¯¼èˆªç»Ÿä¸€ã€é—®é¢˜è¿½è¸ªæ›´æ–°
>   - æ–°å¢æ–‡ä»¶: pages/api/chat/stream.ts, services/chat.ts, stores/chatStore.ts, hooks/useChat.ts, types/next-auth.d.ts
>   - æ¶æ„å˜æ›´: é‡‡ç”¨ DeepSeek ç›´è¿è€Œéä»£ç†åˆ°å°ç¨‹åºåç«¯
>   - æ¢ç´¢æ–‡æ¡£: å°ç¨‹åº prompt ç³»ç»Ÿç»“æ„å·²åˆ†æï¼Œå¾…åç»­åŒæ­¥
> - v3.4: Sprint 0 å®Œæˆï¼Œæ›´æ–°ä»»åŠ¡æ¸…å•çŠ¶æ€ï¼Œç»Ÿä¸€ç§»åŠ¨ç«¯æ±‰å ¡èœå•è®¾è®¡
> - v3.3: æ·»åŠ  /api/user-stats.ts ç«¯ç‚¹ï¼ˆä»£ç†åç«¯ç”¨æˆ·ç»Ÿè®¡APIï¼‰ï¼Œç§»é™¤å¯¹Mailchimp waitlistçš„ä¾èµ–
> - v3.2: åœ¨æ¯ä¸ªSprintæœ«å°¾æ·»åŠ éªŒè¯æ£€æŸ¥ç‚¹ï¼Œç¡®ä¿éªŒè¯ç¯èŠ‚ä¸é—æ¼
> **ä¸‹æ¬¡å®¡æŸ¥**: Sprint 1.2 å¼€å§‹å‰
